<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="<%= BASE_URL %>logos.ico" />
    <title><%= htmlWebpackPlugin.options.title %></title>

    <meta
      name="description"
      content="Pollacheial Networks Tech, the theatrical arts of geek's"
    />
    <meta
      name="keywords"
      content="pollacheial, pollacheial networks, plcnwks, pollcheial network tech, lpkni, dinamika mbojo, bima, kota bima, rumah gerak, nusa vacation"
    />
    <meta name="author" content="POLLACHEIAL NETWORKS TECH" />
  </head>
  <body>
    <noscript>
      <strong>
        We're sorry but <%= htmlWebpackPlugin.options.title %> doesn't work
        properly without JavaScript enabled. Please enable it to continue.
      </strong>
    </noscript>

    <!-- Floating Translate Button -->
    <div id="translate-toggle">üåê</div>
    <div id="google_translate_element" class="hidden"></div>

    <div id="app"></div>

    <style>
      /* Tombol toggle */
      #translate-toggle {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 9999;
        background: black;
        color: white;
        border: 2px solid #000;
        padding: 10px 14px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 18px;
        box-shadow: 2px 2px 0px #000;
        transition: background 0.3s, color 0.3s;
      }
      #translate-toggle:hover {
        background: white;
        color: black;
      }

      /* Kontainer dropdown */
      #google_translate_element {
        position: fixed;
        bottom: 60px;
        right: 20px;
        z-index: 9999;
        background: white;
        border: 2px solid #000;
        padding: 6px 10px;
        border-radius: 6px;
        box-shadow: 2px 2px 0px #000;
      }

      /* Hilangkan background & teks bawaan */
      .goog-te-banner-frame.skiptranslate,
      .goog-te-gadget-simple {
        background: transparent !important;
        border: none !important;
      }
      body {
        top: 0px !important;
      }
      .goog-te-gadget-simple span {
        font-size: 14px !important;
        color: #000 !important;
        font-weight: bold;
      }
      .goog-logo-link {
        display: none !important;
      }
      .goog-te-gadget {
        font-size: 0;
      }
    </style>

    <!-- Google Translate Script -->
    <script type="text/javascript">
      function googleTranslateElementInit() {
        new google.translate.TranslateElement(
          {
            pageLanguage: "en",
            includedLanguages: "id,en,ja,fr,de",
            autoDisplay: false,
          },
          "google_translate_element"
        );

        detectUserLanguage();
      }

      // Toggle Show/Hide Translate Box
      document.addEventListener("DOMContentLoaded", () => {
        const toggleBtn = document.getElementById("translate-toggle");
        const box = document.getElementById("google_translate_element");
        toggleBtn.addEventListener("click", () => {
          box.classList.toggle("hidden");
        });
      });

      // Auto Detect IP
      function detectUserLanguage() {
        fetch("https://ipapi.co/json/")
          .then((res) => res.json())
          .then((data) => {
            const country = data.country_code;
            let lang = "en";
            const mapLang = { ID: "id", JP: "ja", FR: "fr", DE: "de" };
            if (mapLang[country]) lang = mapLang[country];
            if (lang !== "en") autoTranslate(lang);
          })
          .catch(() => {
            autoTranslate("id"); // fallback
          });
      }

      function autoTranslate(lang) {
        let attempts = 10;
        let count = 0;
        function trigger() {
          const frame = document.querySelector(".goog-te-menu-frame");
          if (!frame) {
            if (count < attempts) {
              count++;
              setTimeout(trigger, 500);
            }
            return;
          }
          const frameDoc =
            frame.contentDocument || frame.contentWindow.document;
          const langEl = [
            ...frameDoc.querySelectorAll(".goog-te-menu2-item span.text"),
          ].find((e) => e.innerText.toLowerCase().includes(lang));
          if (langEl) langEl.click();
        }
        trigger();
      }
    </script>

    <script
      type="text/javascript"
      src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
    ></script>
  </body>
</html>
